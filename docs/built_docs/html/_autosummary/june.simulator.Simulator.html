
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>june.simulator.Simulator &#8212; JUNE  documentation</title>
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="june.time.Timer" href="june.time.Timer.html" />
    <link rel="prev" title="june.simulator_box.SimulatorError" href="june.simulator_box.SimulatorError.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>JUNE  documentation</span></a></h1>
        <h2 class="heading"><span>june.simulator.Simulator</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="june.simulator_box.SimulatorError.html">june.simulator_box.SimulatorError</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="june.time.Timer.html">june.time.Timer</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <div class="section" id="june-simulator-simulator">
<h1>june.simulator.Simulator<a class="headerlink" href="#june-simulator-simulator" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">june.simulator.</code><code class="sig-name descname">Simulator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.world.html#june.world.World" title="june.world.World">june.world.World</a></span></em>, <em class="sig-param"><span class="n">interaction</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.interaction.interaction.html#june.interaction.interaction.Interaction" title="june.interaction.interaction.Interaction">june.interaction.interaction.Interaction</a></span></em>, <em class="sig-param"><span class="n">timer</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.time.html#june.time.Timer" title="june.time.Timer">june.time.Timer</a></span></em>, <em class="sig-param"><span class="n">activity_manager</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.activity.activity_manager.html#june.activity.activity_manager.ActivityManager" title="june.activity.activity_manager.ActivityManager">june.activity.activity_manager.ActivityManager</a></span></em>, <em class="sig-param"><span class="n">infection_selector</span><span class="p">:</span> <span class="n">june.infection.infection_selector.InfectionSelector</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">infection_seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>InfectionSeed<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">record</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Record<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint_dates</span><span class="p">:</span> <span class="n">List<span class="p">[</span>datetime.date<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span></dt>
<dd><p>Class to run an epidemic spread simulation on the world.</p>
<dl class="simple">
<dt>world: </dt><dd><p>instance of World class</p>
</dd>
</dl>
<dl class="py class">
<dt>
<em class="property">class </em><code class="sig-name descname">ActivityManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span></em>, <em class="sig-param"><span class="n">policies</span></em>, <em class="sig-param"><span class="n">timer</span></em>, <em class="sig-param"><span class="n">all_activities</span></em>, <em class="sig-param"><span class="n">activity_to_super_groups</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">leisure</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.groups.leisure.leisure.html#june.groups.leisure.leisure.Leisure" title="june.groups.leisure.leisure.Leisure">june.groups.leisure.leisure.Leisure</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">travel</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>june.groups.travel.travel.Travel<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span></dt>
<dd><dl class="py method">
<dt>
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span></em>, <em class="sig-param"><span class="n">policies</span></em>, <em class="sig-param"><span class="n">timer</span></em>, <em class="sig-param"><span class="n">all_activities</span></em>, <em class="sig-param"><span class="n">activity_to_super_groups</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">leisure</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.groups.leisure.leisure.html#june.groups.leisure.leisure.Leisure" title="june.groups.leisure.leisure.Leisure">june.groups.leisure.leisure.Leisure</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">travel</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>june.groups.travel.travel.Travel<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">activities_to_super_groups</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">activities</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>str<span class="p">]</span></dt>
<dd><p>Converts activities into Supergroups, the interaction will run over these Groups.</p>
<dl class="simple">
<dt>activities:</dt><dd><p>list of activities that take place at a given time step</p>
</dd>
</dl>
<p>List of groups that are active.</p>
</dd></dl>

<dl class="py method">
<dt>
<em class="property">static </em><code class="sig-name descname">apply_activity_hierarchy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">activities</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; List<span class="p">[</span>str<span class="p">]</span></dt>
<dd><p>Returns a list of activities with the right order, obeying the permanent activity hierarcy
and shuflling the random one.</p>
<dl class="simple">
<dt>activities:</dt><dd><p>list of activities that take place at a given time step</p>
</dd>
</dl>
<p>Ordered list of activities according to hierarchy</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">do_timestep</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">move_people_to_active_subgroups</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">activities</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">date</span><span class="p">:</span> <span class="n">datetime.datetime</span> <span class="o">=</span> <span class="default_value">datetime.datetime(2020, 2, 2, 0, 0)</span></em>, <em class="sig-param"><span class="n">days_from_start</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span></dt>
<dd><p>Sends every person to one subgroup. If a person has a mild illness,
they stay at home</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">move_to_active_subgroup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">activities</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">person</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.demography.person.html#june.demography.person.Person" title="june.demography.person.Person">june.demography.person.Person</a></span></em>, <em class="sig-param"><span class="n">to_send_abroad</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span><a class="reference internal" href="june.groups.group.subgroup.html#june.groups.group.subgroup.Subgroup" title="june.groups.group.subgroup.Subgroup">june.groups.group.subgroup.Subgroup</a><span class="p">]</span></dt>
<dd><p>Given the hierarchy of activities and a person, decide what subgroup
should they go to</p>
<dl class="simple">
<dt>activities:</dt><dd><p>list of activities that take place at a given time step</p>
</dd>
<dt>person:</dt><dd><p>person that is looking for a subgroup to go to</p>
</dd>
</dl>
<p>Subgroup to which person has to go, given the hierarchy of activities</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">send_and_receive_people_from_abroad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">movable_people</span></em><span class="sig-paren">)</span></dt>
<dd><p>Deal with the MPI comms.</p>
</dd></dl>

<dl class="py method">
<dt>
<em class="property">property </em><code class="sig-name descname">active_super_groups</code></dt>
<dd></dd></dl>

<dl class="py method">
<dt>
<em class="property">property </em><code class="sig-name descname">all_super_groups</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.world.html#june.world.World" title="june.world.World">june.world.World</a></span></em>, <em class="sig-param"><span class="n">interaction</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.interaction.interaction.html#june.interaction.interaction.Interaction" title="june.interaction.interaction.Interaction">june.interaction.interaction.Interaction</a></span></em>, <em class="sig-param"><span class="n">timer</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.time.html#june.time.Timer" title="june.time.Timer">june.time.Timer</a></span></em>, <em class="sig-param"><span class="n">activity_manager</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.activity.activity_manager.html#june.activity.activity_manager.ActivityManager" title="june.activity.activity_manager.ActivityManager">june.activity.activity_manager.ActivityManager</a></span></em>, <em class="sig-param"><span class="n">infection_selector</span><span class="p">:</span> <span class="n">june.infection.infection_selector.InfectionSelector</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">infection_seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>InfectionSeed<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">record</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Record<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint_dates</span><span class="p">:</span> <span class="n">List<span class="p">[</span>datetime.date<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">checkpoint_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span></dt>
<dd><p>Class to run an epidemic spread simulation on the world.</p>
<dl class="simple">
<dt>world: </dt><dd><p>instance of World class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">bury_the_dead</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.world.html#june.world.World" title="june.world.World">june.world.World</a></span></em>, <em class="sig-param"><span class="n">person</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.demography.person.html#june.demography.person.Person" title="june.demography.person.Person">june.demography.person.Person</a></span></em><span class="sig-paren">)</span></dt>
<dd><p>When someone dies, send them to cemetery. 
ZOMBIE ALERT!!</p>
<p>time
person:</p>
<blockquote>
<div><p>person to send to cemetery</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt>
<em class="property">static </em><code class="sig-name descname">check_inputs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_config</span><span class="p">:</span> <span class="n">dict</span></em><span class="sig-paren">)</span></dt>
<dd><p>Check that the iput time configuration is correct, i.e., activities are among allowed activities
and days have 24 hours.</p>
<dl class="simple">
<dt>time_config:</dt><dd><p>dictionary with time steps configuration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">clear_world</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Removes everyone from all possible groups, and sets everyone’s busy attribute
to False.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">do_timestep</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Perform a time step in the simulation. First, ActivityManager is called
to send people to the corresponding subgroups according to the current daytime.
Then we iterate over all the groups and create an InteractiveGroup object, which
extracts the relevant information of each group to carry the interaction in it.
We then pass the interactive group to the interaction module, which returns the ids 
of the people who got infected. We record the infection locations, update the health
status of the population, and distribute scores among the infectors to calculate R0.</p>
</dd></dl>

<dl class="py method">
<dt>
<em class="property">classmethod </em><code class="sig-name descname">from_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.world.html#june.world.World" title="june.world.World">june.world.World</a></span></em>, <em class="sig-param"><span class="n">checkpoint_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">interaction</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.interaction.interaction.html#june.interaction.interaction.Interaction" title="june.interaction.interaction.Interaction">june.interaction.interaction.Interaction</a></span></em>, <em class="sig-param"><span class="n">infection_selector</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">policies</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.policy.policy.html#june.policy.policy.Policies" title="june.policy.policy.Policies">june.policy.policy.Policies</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">infection_seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.infection_seed.infection_seed.html#june.infection_seed.infection_seed.InfectionSeed" title="june.infection_seed.infection_seed.InfectionSeed">june.infection_seed.infection_seed.InfectionSeed</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leisure</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.groups.leisure.leisure.html#june.groups.leisure.leisure.Leisure" title="june.groups.leisure.leisure.Leisure">june.groups.leisure.leisure.Leisure</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">travel</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>june.groups.travel.travel.Travel<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_filename</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">PosixPath('/home/sadie/JUNE/configs/config_example.yaml')</span></em>, <em class="sig-param"><span class="n">record</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Record<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py method">
<dt>
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">world</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.world.html#june.world.World" title="june.world.World">june.world.World</a></span></em>, <em class="sig-param"><span class="n">interaction</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.interaction.interaction.html#june.interaction.interaction.Interaction" title="june.interaction.interaction.Interaction">june.interaction.interaction.Interaction</a></span></em>, <em class="sig-param"><span class="n">infection_selector</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">policies</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.policy.policy.html#june.policy.policy.Policies" title="june.policy.policy.Policies">june.policy.policy.Policies</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">infection_seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.infection_seed.infection_seed.html#june.infection_seed.infection_seed.InfectionSeed" title="june.infection_seed.infection_seed.InfectionSeed">june.infection_seed.infection_seed.InfectionSeed</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">leisure</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="june.groups.leisure.leisure.html#june.groups.leisure.leisure.Leisure" title="june.groups.leisure.leisure.Leisure">june.groups.leisure.leisure.Leisure</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">travel</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>june.groups.travel.travel.Travel<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_filename</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">PosixPath('/home/sadie/JUNE/configs/config_example.yaml')</span></em>, <em class="sig-param"><span class="n">checkpoint_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">record</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Record<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="june.simulator.html#june.simulator.Simulator" title="june.simulator.Simulator">Simulator</a></dt>
<dd><p>Load config for simulator from world.yaml</p>
<p>leisure
infection_seed
policies
interaction
world
config_filename</p>
<blockquote>
<div><p>The path to the world yaml configuration</p>
</div></blockquote>
<dl class="simple">
<dt>comment</dt><dd><p>A brief description of the purpose of the run(s)</p>
</dd>
</dl>
<p>A Simulator</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">infect_people</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">infected_ids</span></em>, <em class="sig-param"><span class="n">people_from_abroad_dict</span></em><span class="sig-paren">)</span></dt>
<dd><p>Given a list of infected ids, it initialises an infection object for them
and sets it to person.infection. For the people who do not live in this domain
a dictionary with their ids and domains is prepared to be sent through MPI.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">recover</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">person</span><span class="p">:</span> <span class="n"><a class="reference internal" href="june.demography.person.html#june.demography.person.Person" title="june.demography.person.Person">june.demography.person.Person</a></span></em><span class="sig-paren">)</span></dt>
<dd><p>When someone recovers, erase the health information they carry and change their susceptibility.</p>
<dl class="simple">
<dt>person:</dt><dd><p>person to recover</p>
</dd>
<dt>time:</dt><dd><p>time (in days), at which the person recovers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Run simulation with n_seed initial infections</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">save_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">saving_date</span></em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">tell_domains_to_infect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">infect_in_domains</span></em><span class="sig-paren">)</span></dt>
<dd><p>Sends information about the people who got infected in this domain to the other domains.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">update_health_status</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">duration</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span></dt>
<dd><p>Update symptoms and health status of infected people.
Send them to hospital if necessary, or bury them if they
have died.</p>
<dl class="simple">
<dt>time:</dt><dd><p>time now</p>
</dd>
<dt>duration:</dt><dd><p>duration of time step</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="june.simulator_box.SimulatorError.html">june.simulator_box.SimulatorError</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="june.time.Timer.html">june.time.Timer</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, IDAS-Durham.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
    </div>
  </body>
</html>